// Biathlon World Cup Schedule 2025/2026
const biathlonSchedule = [
    {
        dates: "29 november–7 december 2025",
        location: "Östersund, Sverige",
        events: [
            { 
                date: "29 november", 
                races: [
                    { name: "Stafett 4x6 km, damer", tv: "13:15-14:35, SVT1/SVT Play" },
                    { name: "Stafett 4x7,5 km, herrar", tv: "16:55-18:15, SVT1/SVT Play" }
                ]
            },
            { 
                date: "30 november", 
                races: [
                    { name: "Singelmixedstafett", tv: "14:00-14:45, SVT1/SVT Play" },
                    { name: "Mixedstafett", tv: "16:40-17:50, SVT1/SVT Play" }
                ]
            },
            { 
                date: "2 december", 
                races: [
                    { name: "Distans 15 km, damer", tv: "15:20-17:20, SVT1/SVT Play" }
                ]
            },
            { 
                date: "3 december", 
                races: [
                    { name: "Distans 20 km, herrar", tv: "15:20-17:20, SVT1/SVT Play" }
                ]
            },
            { 
                date: "5 december", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "15:50-17:25, SVT1/SVT Play" }
                ]
            },
            { 
                date: "6 december", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "16:30-17:50, SVT1/SVT Play" }
                ]
            },
            { 
                date: "7 december", 
                races: [
                    { name: "Jaktstart 10 km, damer", tv: "13:15-14:00, SVT1/SVT Play" },
                    { name: "Jaktstart 12,5 km, herrar", tv: "15:15-16:00, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "12–14 december 2025",
        location: "Hochfilzen, Österrike",
        events: [
            { 
                date: "12 december", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "11:15-12:55, SVT1/SVT Play" },
                    { name: "Sprint 7,5 km, damer", tv: "14:05-15:45, SVT1/SVT Play" }
                ]
            },
            { 
                date: "13 december", 
                races: [
                    { name: "Jaktstart 12,5 km, herrar", tv: "12:00-12:45, SVT1/SVT Play" },
                    { name: "Stafett 4x6 km, damer", tv: "14:15-15:35, SVT1/SVT Play" }
                ]
            },
            { 
                date: "14 december", 
                races: [
                    { name: "Stafett 4x7,5 km, herrar", tv: "12:00-13:20, SVT1/SVT Play" },
                    { name: "Jaktstart 10 km, damer", tv: "14:45-15:30, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "18–21 december 2025",
        location: "Annecy-Le Grand Bornand, Frankrike",
        events: [
            { 
                date: "18 december", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "14:05-15:45, SVT1/SVT Play" }
                ]
            },
            { 
                date: "19 december", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "14:05-15:40, SVT1/SVT Play" }
                ]
            },
            { 
                date: "20 december", 
                races: [
                    { name: "Jaktstart 10 km, damer", tv: "12:15-13:00, SVT1/SVT Play" },
                    { name: "Jaktstart 12,5 km, herrar", tv: "14:45-15:30, SVT1/SVT Play" }
                ]
            },
            { 
                date: "21 december", 
                races: [
                    { name: "Masstart 12,5 km, damer", tv: "12:15-13:00, SVT1/SVT Play" },
                    { name: "Masstart 15 km, herrar", tv: "14:45-15:30, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "8–11 januari 2026",
        location: "Oberhof, Tyskland",
        events: [
            { 
                date: "8 januari", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "14:00-15:40, SVT1/SVT Play" }
                ]
            },
            { 
                date: "9 januari", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "14:15-15:50, SVT1/SVT Play" }
                ]
            },
            { 
                date: "10 januari", 
                races: [
                    { name: "Jaktstart 12,5 km, herrar", tv: "12:00-12:45, SVT1/SVT Play" },
                    { name: "Stafett 4x6 km, damer", tv: "14:25-15:40, SVT1/SVT Play" }
                ]
            },
            { 
                date: "11 januari", 
                races: [
                    { name: "Stafett 4x7,5 km, herrar", tv: "11:00-12:20, SVT1/SVT Play" },
                    { name: "Jaktstart 10 km, damer", tv: "14:15-15:00, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "14–18 januari 2026",
        location: "Ruhpolding, Tyskland",
        events: [
            { 
                date: "14 januari", 
                races: [
                    { name: "Stafett 4x6 km, damer", tv: "14:20-15:55, SVT1/SVT Play" }
                ]
            },
            { 
                date: "15 januari", 
                races: [
                    { name: "Stafett 4x7,5 km, herrar", tv: "14:20-15:55, SVT1/SVT Play" }
                ]
            },
            { 
                date: "16 januari", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "14:20-15:55, SVT1/SVT Play" }
                ]
            },
            { 
                date: "17 januari", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "14:30-15:50, SVT1/SVT Play" }
                ]
            },
            { 
                date: "18 januari", 
                races: [
                    { name: "Jaktstart 10 km, damer", tv: "12:30-13:15, SVT1/SVT Play" },
                    { name: "Jaktstart 12,5 km, herrar", tv: "15:00-15:45, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "22–25 januari 2026",
        location: "Nove Mesto na Morave, Tjeckien",
        events: [
            { 
                date: "22 januari", 
                races: [
                    { name: "Kortdistans 15 km, herrar", tv: "18:05-20:00, SVT1/SVT Play" }
                ]
            },
            { 
                date: "23 januari", 
                races: [
                    { name: "Kortdistans 12,5 km, damer", tv: "18:05-20:00, SVT1/SVT Play" }
                ]
            },
            { 
                date: "24 januari", 
                races: [
                    { name: "Singelmixedstafett", tv: "13:15-14:00, SVT1/SVT Play" },
                    { name: "Mixedstafett", tv: "15:15-16:25, SVT1/SVT Play" }
                ]
            },
            { 
                date: "25 januari", 
                races: [
                    { name: "Masstart 15 km, herrar", tv: "15:15-16:00, SVT1/SVT Play" },
                    { name: "Masstart 12,5 km, damer", tv: "18:15-19:00, SVT1/SVT Play" }
                ]
            }
        ]
    },
    {
        dates: "5–8 mars 2026",
        location: "Kontiolahti, Finland",
        events: [
            { 
                date: "5 mars", 
                races: [
                    { name: "Distans 15 km, damer", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "6 mars", 
                races: [
                    { name: "Distans 20 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "7 mars", 
                races: [
                    { name: "Masstart 12,5 km, damer", tv: "SVT (tider uppdateras)" },
                    { name: "Stafett 4x7,5 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "8 mars", 
                races: [
                    { name: "Stafett 4x6 km, damer", tv: "SVT (tider uppdateras)" },
                    { name: "Masstart 15 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            }
        ]
    },
    {
        dates: "12–15 mars 2026",
        location: "Otepää, Estland",
        events: [
            { 
                date: "12 mars", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "13 mars", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "14 mars", 
                races: [
                    { name: "Jaktstart 12,5 km, herrar", tv: "SVT (tider uppdateras)" },
                    { name: "Jaktstart 10 km, damer", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "15 mars", 
                races: [
                    { name: "Singelmixedstafett", tv: "SVT (tider uppdateras)" },
                    { name: "Mixedstafett", tv: "SVT (tider uppdateras)" }
                ]
            }
        ]
    },
    {
        dates: "19–22 mars 2026",
        location: "Oslo, Norge",
        events: [
            { 
                date: "19 mars", 
                races: [
                    { name: "Sprint 7,5 km, damer", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "20 mars", 
                races: [
                    { name: "Sprint 10 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "21 mars", 
                races: [
                    { name: "Jaktstart 10 km, damer", tv: "SVT (tider uppdateras)" },
                    { name: "Jaktstart 12,5 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            },
            { 
                date: "22 mars", 
                races: [
                    { name: "Masstart 12,5 km, damer", tv: "SVT (tider uppdateras)" },
                    { name: "Masstart 15 km, herrar", tv: "SVT (tider uppdateras)" }
                ]
            }
        ]
    }
];

// Handball World Championship 2025 - Sweden Matches
const handballSchedule = [
    {
        date: "27 nov (Tors)",
        time: "20:30",
        match: "Sverige – Tjeckien",
        arena: "Porsche-Arena, Stuttgart"
    },
    {
        date: "29 nov (Lör)",
        time: "20:30",
        match: "Kuba – Sverige",
        arena: "Porsche-Arena, Stuttgart"
    },
    {
        date: "1 dec (Mån)",
        time: "20:30",
        match: "Sverige – Brasilien",
        arena: "Porsche-Arena, Stuttgart"
    }
];

// Vinterstudion Schedule 2025/2026
const vinterstudionSchedule = [
    { date: "2025-11-15", time: "09:30–13:45", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-15", time: "10:00–11:30", sport: "Skidskytte, Idre", event: "Sprint (d)" },
    { date: "2025-11-15", time: "12:30–14:15", sport: "Skidskytte, Idre", event: "Sprint (h)" },
    { date: "2025-11-16", time: "09:15–13:45", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-16", time: "10:00–11:30", sport: "Skidskytte, Idre", event: "Sprint (d)" },
    { date: "2025-11-16", time: "12:30–14:15", sport: "Skidskytte, Idre", event: "Sprint (h)" },
    { date: "2025-11-21", time: "09:40–11:20", sport: "Längdskidor, Gällivare", event: "Prolog sprint" },
    { date: "2025-11-21", time: "12:00–14:15", sport: "Längdskidor, Gällivare", event: "Final sprint" },
    { date: "2025-11-22", time: "10:00–13:30", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-22", time: "10:25–11:15", sport: "Längdskidor, Gällivare", event: "10 km klassiskt (h)" },
    { date: "2025-11-22", time: "12:15–13:05", sport: "Längdskidor, Gällivare", event: "10 km klassiskt (d)" },
    { date: "2025-11-23", time: "10:00–13:30", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-23", time: "10:25–11:15", sport: "Längdskidor, Gällivare", event: "10 km fristil (h)" },
    { date: "2025-11-23", time: "12:15–13:05", sport: "Längdskidor, Gällivare", event: "10 km fristil (d)" },
    { date: "2025-11-29", time: "12:45–18:30", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-29", time: "13:15–14:35", sport: "Skidskytte, Östersund", event: "Stafett (d)" },
    { date: "2025-11-29", time: "16:55–18:15", sport: "Skidskytte, Östersund", event: "Stafett (h)" },
    { date: "2025-11-30", time: "13:45–18:00", sport: "Vinterstudion", event: "–" },
    { date: "2025-11-30", time: "14:00–14:45", sport: "Skidskytte, Östersund", event: "Singlemixed stafett" },
    { date: "2025-11-30", time: "16:40–17:50", sport: "Skidskytte, Östersund", event: "Mixed stafett" },
    { date: "2025-12-02", time: "15:20–17:20", sport: "Skidskytte, Östersund", event: "Individuell start 15 km (d)" },
    { date: "2025-12-03", time: "15:20–17:20", sport: "Skidskytte, Östersund", event: "Individuell start 20 km (h)" },
    { date: "2025-12-05", time: "15:50–17:25", sport: "Skidskytte, Östersund", event: "Sprint (d)" },
    { date: "2025-12-06", time: "16:00–18:00", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-06", time: "16:30–17:50", sport: "Skidskytte, Östersund", event: "Sprint (h)" },
    { date: "2025-12-07", time: "13:00–16:30", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-07", time: "13:15–14:00", sport: "Skidskytte, Östersund", event: "Jaktstart (d)" },
    { date: "2025-12-07", time: "15:15–16:00", sport: "Skidskytte, Östersund", event: "Jaktstart (h)" },
    { date: "2025-12-12", time: "11:15–12:55", sport: "Skidskytte, Hochfilzen", event: "Sprint (h)" },
    { date: "2025-12-12", time: "14:05–15:45", sport: "Skidskytte, Hochfilzen", event: "Sprint (d)" },
    { date: "2025-12-13", time: "11:30–15:50", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-13", time: "08:15–11:30", sport: "Ski Classics, Bad Gastein", event: "Individuell 7 km" },
    { date: "2025-12-13", time: "12:00–12:45", sport: "Skidskytte, Hochfilzen", event: "Jaktstart (h)" },
    { date: "2025-12-13", time: "14:15–15:35", sport: "Skidskytte, Hochfilzen", event: "Stafett (d)" },
    { date: "2025-12-14", time: "11:30–15:50", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-14", time: "08:20–11:30", sport: "Ski Classics, Bad Gastein", event: "Criterium 36 km" },
    { date: "2025-12-14", time: "12:00–13:20", sport: "Skidskytte, Hochfilzen", event: "Stafett (h)" },
    { date: "2025-12-14", time: "14:45–15:30", sport: "Skidskytte, Hochfilzen", event: "Jaktstart (d)" },
    { date: "2025-12-18", time: "14:05–15:45", sport: "Skidskytte, Annecy", event: "Sprint (d)" },
    { date: "2025-12-19", time: "14:05–15:40", sport: "Skidskytte, Annecy", event: "Sprint (h)" },
    { date: "2025-12-20", time: "12:00–16:00", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-20", time: "12:15–13:00", sport: "Skidskytte, Annecy", event: "Jaktstart (d)" },
    { date: "2025-12-20", time: "14:45–15:30", sport: "Skidskytte, Annecy", event: "Jaktstart (h)" },
    { date: "2025-12-21", time: "12:00–16:00", sport: "Vinterstudion", event: "–" },
    { date: "2025-12-21", time: "12:15–13:00", sport: "Skidskytte, Annecy", event: "Masstart (d)" },
    { date: "2025-12-21", time: "14:45–15:30", sport: "Skidskytte, Annecy", event: "Masstart (h)" },
    { date: "2026-01-08", time: "14:00–15:40", sport: "Skidskytte, Oberhof", event: "Sprint (h)" },
    { date: "2026-01-09", time: "14:15–15:50", sport: "Skidskytte, Oberhof", event: "Sprint (d)" },
    { date: "2026-01-10", time: "11:30–16:00", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-10", time: "12:00–12:45", sport: "Skidskytte, Oberhof", event: "Jaktstart (h)" },
    { date: "2026-01-10", time: "14:25–15:40", sport: "Skidskytte, Oberhof", event: "Stafett (d)" },
    { date: "2026-01-11", time: "10:45–15:30", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-11", time: "11:00–12:20", sport: "Skidskytte, Oberhof", event: "Stafett (h)" },
    { date: "2026-01-11", time: "14:15–15:00", sport: "Skidskytte, Oberhof", event: "Jaktstart (h)" },
    { date: "2026-01-14", time: "14:20–15:55", sport: "Skidskytte, Ruhpolding", event: "Stafett (d)" },
    { date: "2026-01-15", time: "14:20–15:55", sport: "Skidskytte, Ruhpolding", event: "Stafett (h)" },
    { date: "2026-01-16", time: "14:20–15:55", sport: "Skidskytte, Ruhpolding", event: "Sprint (d)" },
    { date: "2026-01-17", time: "14:00–16:15", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-17", time: "09:45–12:50", sport: "Längdskidor, Engadin La Diagonela", event: "55 km" },
    { date: "2026-01-17", time: "14:30–15:50", sport: "Skidskytte, Ruhpolding", event: "Sprint (h)" },
    { date: "2026-01-18", time: "12:15–16:00", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-18", time: "12:30–13:15", sport: "Skidskytte, Ruhpolding", event: "Jaktstart (d)" },
    { date: "2026-01-18", time: "15:00–15:45", sport: "Skidskytte, Ruhpolding", event: "Jaktstart (h)" },
    { date: "2026-01-22", time: "18:05–20:00", sport: "Skidskytte, Nove Mesto", event: "Individuell start 15 km (h)" },
    { date: "2026-01-23", time: "18:05–20:00", sport: "Skidskytte, Nove Mesto", event: "Individuell start 12.5 km (d)" },
    { date: "2026-01-24", time: "12:45–16:45", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-24", time: "13:15–14:00", sport: "Skidskytte, Nove Mesto", event: "Singlemixed stafett" },
    { date: "2026-01-24", time: "15:15–16:25", sport: "Skidskytte, Nove Mesto", event: "Mixed stafett" },
    { date: "2026-01-25", time: "15:00–19:15", sport: "Vinterstudion", event: "–" },
    { date: "2026-01-25", time: "07:50–11:30", sport: "Längdskidor, Marcialonga", event: "70 km" },
    { date: "2026-01-25", time: "15:15–16:00", sport: "Skidskytte, Nove Mesto", event: "Masstart (h)" },
    { date: "2026-01-25", time: "18:15–19:00", sport: "Skidskytte, Nove Mesto", event: "Masstart (d)" }
];

// Packers 2025 NFL Season Schedule (Swedish Times)
const packersSchedule = [
    {
        week: 1,
        date: "September 7, 2025",
        time: "22:25 (Swedish Time)",
        opponent: "Detroit Lions",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 2,
        date: "September 11, 2025",
        time: "02:15 (Sept 12, Swedish Time)",
        opponent: "Washington Commanders",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 3,
        date: "September 21, 2025",
        time: "19:00 (Swedish Time)",
        opponent: "Cleveland Browns",
        location: "away",
        stadium: "Cleveland Browns Stadium"
    },
    {
        week: 4,
        date: "September 28, 2025",
        time: "00:20 (Sept 29, Swedish Time)",
        opponent: "Dallas Cowboys",
        location: "away",
        stadium: "AT&T Stadium"
    },
    {
        week: 5,
        date: "October 5, 2025",
        time: "BYE WEEK",
        opponent: null,
        location: null,
        stadium: null
    },
    {
        week: 6,
        date: "October 12, 2025",
        time: "20:25 (Swedish Time)",
        opponent: "Cincinnati Bengals",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 7,
        date: "October 19, 2025",
        time: "20:25 (Swedish Time)",
        opponent: "Arizona Cardinals",
        location: "away",
        stadium: "State Farm Stadium"
    },
    {
        week: 8,
        date: "October 26, 2025",
        time: "02:20 (Oct 27, Swedish Time)",
        opponent: "Pittsburgh Steelers",
        location: "away",
        stadium: "Acrisure Stadium"
    },
    {
        week: 9,
        date: "November 2, 2025",
        time: "19:00 (Swedish Time)",
        opponent: "Carolina Panthers",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 10,
        date: "November 10, 2025",
        time: "01:15 (Nov 11, Swedish Time)",
        opponent: "Philadelphia Eagles",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 11,
        date: "November 16, 2025",
        time: "19:00 (Swedish Time)",
        opponent: "New York Giants",
        location: "away",
        stadium: "MetLife Stadium"
    },
    {
        week: 12,
        date: "November 23, 2025",
        time: "18:00 (Swedish Time)",
        opponent: "Minnesota Vikings",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 13,
        date: "November 27, 2025",
        time: "18:00 (Swedish Time)",
        opponent: "Detroit Lions",
        location: "away",
        stadium: "Ford Field"
    },
    {
        week: 14,
        date: "December 7, 2025",
        time: "21:25 (Swedish Time)",
        opponent: "Chicago Bears",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 15,
        date: "December 14, 2025",
        time: "21:25 (Swedish Time)",
        opponent: "Denver Broncos",
        location: "away",
        stadium: "Empower Field at Mile High"
    },
    {
        week: 16,
        date: "December 20, 2025",
        time: "TBD",
        opponent: "Chicago Bears",
        location: "away",
        stadium: "Soldier Field"
    },
    {
        week: 17,
        date: "TBD",
        time: "TBD",
        opponent: "Baltimore Ravens",
        location: "home",
        stadium: "Lambeau Field"
    },
    {
        week: 18,
        date: "January 3/4, 2026",
        time: "TBD",
        opponent: "Minnesota Vikings",
        location: "away",
        stadium: "U.S. Bank Stadium"
    }
];

// DOM Elements
const scheduleContainer = document.getElementById('schedule-container');

// Helper function to parse dates from different formats
function parseDate(dateString) {
    // Remove day names in parentheses like (Tors), (Lör), (Mån)
    let cleanDate = dateString.replace(/\s*\([^)]*\)/g, '');
    
    // Swedish month names to numbers
    const monthMap = {
        'januari': 0, 'februari': 1, 'mars': 2, 'april': 3,
        'maj': 4, 'juni': 5, 'juli': 6, 'augusti': 7,
        'september': 8, 'oktober': 9, 'november': 10, 'december': 11,
        'jan': 0, 'feb': 1, 'mar': 2, 'apr': 3,
        'maj': 4, 'jun': 5, 'jul': 6, 'aug': 7,
        'sep': 8, 'okt': 9, 'nov': 10, 'dec': 11
    };
    
    // Try Swedish format: "29 november" or "7 december 2025"
    const swedishMatch = cleanDate.match(/(\d{1,2})\s+(januari|februari|mars|april|maj|juni|juli|augusti|september|oktober|november|december|jan|feb|mar|apr|maj|jun|jul|aug|sep|okt|nov|dec)(?:\s+(\d{4}))?/i);
    if (swedishMatch) {
        const day = parseInt(swedishMatch[1]);
        const month = monthMap[swedishMatch[2].toLowerCase()];
        const year = swedishMatch[3] ? parseInt(swedishMatch[3]) : 2025;
        return new Date(year, month, day);
    }
    
    // Try American format: "September 7, 2025" or "November 16, 2025"
    const americanMatch = cleanDate.match(/(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{1,2}),?\s+(\d{4})/i);
    if (americanMatch) {
        const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const month = monthNames.findIndex(m => m.toLowerCase() === americanMatch[1].toLowerCase());
        const day = parseInt(americanMatch[2]);
        const year = parseInt(americanMatch[3]);
        return new Date(year, month, day);
    }
    
    return null;
}

// Function to get all events from all sports
function getAllEvents() {
    const events = [];
    
    // Add Packers games
    packersSchedule.forEach(game => {
        if (game.opponent !== null) {
            const date = parseDate(game.date);
            if (date) {
                events.push({
                    date: date,
                    dateString: game.date,
                    sport: 'NFL',
                    team: 'Green Bay Packers',
                    description: game.location === 'home' ? `vs ${game.opponent}` : `@ ${game.opponent}`,
                    location: game.stadium,
                    time: game.time
                });
            }
        }
    });
    
    // Add Biathlon events
    biathlonSchedule.forEach(competition => {
        competition.events.forEach(event => {
            const date = parseDate(event.date);
            if (date) {
                event.races.forEach(race => {
                    events.push({
                        date: date,
                        dateString: event.date,
                        sport: 'Skidskytte',
                        team: competition.location,
                        description: race.name,
                        location: competition.location,
                        time: race.tv
                    });
                });
            }
        });
    });
    
    // Add Handball matches
    handballSchedule.forEach(game => {
        const date = parseDate(game.date);
        if (date) {
            events.push({
                date: date,
                dateString: game.date,
                sport: 'Handboll VM',
                team: 'Sverige',
                description: game.match,
                location: game.arena,
                time: game.time
            });
        }
    });
    
    // Add Vinterstudion events
    vinterstudionSchedule.forEach(item => {
        const date = parseDate(item.date);
        if (date) {
            // Only add non-Vinterstudion events (actual sports events)
            if (item.sport !== 'Vinterstudion') {
                events.push({
                    date: date,
                    dateString: item.date,
                    sport: 'Vinterstudion',
                    team: item.sport,
                    description: item.event,
                    location: item.sport,
                    time: item.time
                });
            }
        }
    });
    
    return events;
}

// Function to filter events for today
function getTodaysEvents() {
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    
    const allEvents = getAllEvents();
    return allEvents.filter(event => {
        return event.date >= today && event.date < tomorrow;
    }).sort((a, b) => a.date - b.date);
}

// Function to filter events for next 7 days (excluding today)
function getUpcomingEvents() {
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    
    const nextWeek = new Date(today);
    nextWeek.setDate(nextWeek.getDate() + 8);
    
    const allEvents = getAllEvents();
    return allEvents.filter(event => {
        return event.date >= tomorrow && event.date < nextWeek;
    }).sort((a, b) => a.date - b.date);
}

// Function to create NFL table
function createNFLTable(schedule) {
    const table = document.createElement('table');
    table.className = 'schedule-table';
    
    // Find next game
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    let nextGameIndex = -1;
    for (let i = 0; i < schedule.length; i++) {
        if (schedule[i].opponent !== null) {
            const gameDate = parseDate(schedule[i].date);
            if (gameDate && gameDate >= today) {
                nextGameIndex = i;
                break;
            }
        }
    }
    
    let html = `
        <caption>Green Bay Packers - 2025 Schedule</caption>
        <thead>
            <tr>
                <th>Week</th>
                <th>Date</th>
                <th>Opponent</th>
                <th>Location</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody>
    `;
    
    schedule.forEach((game, index) => {
        // Skip games that have already occurred
        const gameDate = parseDate(game.date);
        if (gameDate && gameDate < today && game.opponent !== null) {
            return; // Skip past games
        }
        
        const isNextGame = index === nextGameIndex;
        const rowClass = isNextGame ? ' class="next-event"' : '';
        
        if (game.opponent === null) {
            html += `
                <tr${rowClass}>
                    <td>${game.week}</td>
                    <td>${game.date}</td>
                    <td colspan="3">BYE WEEK</td>
                </tr>
            `;
        } else {
            const opponent = game.location === 'home' ? `vs ${game.opponent}` : `@ ${game.opponent}`;
            
            html += `
                <tr${rowClass}>
                    <td>${game.week}</td>
                    <td>${game.date}</td>
                    <td>${opponent}</td>
                    <td>${game.stadium}</td>
                    <td>${game.time}</td>
                </tr>
            `;
        }
    });
    
    html += `</tbody>`;
    table.innerHTML = html;
    return table;
}

// Function to create biathlon tables
function createBiathlonTables(schedule) {
    const container = document.createElement('div');
    
    // Find next event date across all competitions
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    let nextEventDate = null;
    for (const competition of schedule) {
        for (const event of competition.events) {
            const eventDate = parseDate(event.date);
            if (eventDate && eventDate >= today) {
                if (!nextEventDate || eventDate < nextEventDate) {
                    nextEventDate = eventDate;
                }
            }
        }
    }
    
    schedule.forEach(competition => {
        // Check if competition has any future events
        const hasFutureEvents = competition.events.some(event => {
            const eventDate = parseDate(event.date);
            return eventDate && eventDate >= today;
        });
        
        // Skip competition if all events have passed
        if (!hasFutureEvents) {
            return;
        }
        
        const section = document.createElement('div');
        section.className = 'competition-section';
        
        const title = document.createElement('div');
        title.className = 'competition-title';
        title.textContent = competition.location;
        
        const dates = document.createElement('div');
        dates.className = 'competition-dates';
        dates.textContent = competition.dates;
        
        const table = document.createElement('table');
        table.className = 'schedule-table';
        
        let html = `
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Event</th>
                    <th>SVT Broadcast</th>
                </tr>
            </thead>
            <tbody>
        `;
        
        competition.events.forEach(event => {
            const eventDate = parseDate(event.date);
            
            // Skip events that have already occurred
            if (eventDate && eventDate < today) {
                return;
            }
            
            const isNextEvent = nextEventDate && eventDate && 
                               eventDate.getTime() === nextEventDate.getTime();
            const rowClass = isNextEvent ? ' class="next-event"' : '';
            
            event.races.forEach((race, index) => {
                html += `
                    <tr${rowClass}>
                        <td>${index === 0 ? event.date : ''}</td>
                        <td>${race.name}</td>
                        <td>${race.tv}</td>
                    </tr>
                `;
            });
        });
        
        html += `</tbody>`;
        table.innerHTML = html;
        
        section.appendChild(title);
        section.appendChild(dates);
        section.appendChild(table);
        container.appendChild(section);
    });
    
    return container;
}

// Function to display NFL schedule
function displaySchedule(schedule) {
    scheduleContainer.innerHTML = '';
    const table = createNFLTable(schedule);
    scheduleContainer.appendChild(table);
}

// Function to display biathlon schedule
function displayBiathlonSchedule(schedule) {
    scheduleContainer.innerHTML = '';
    const tables = createBiathlonTables(schedule);
    scheduleContainer.appendChild(tables);
}

// Function to create handball table
function createHandballTable(schedule) {
    const table = document.createElement('table');
    table.className = 'schedule-table';
    
    // Find next match
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    let nextMatchIndex = -1;
    for (let i = 0; i < schedule.length; i++) {
        const matchDate = parseDate(schedule[i].date);
        if (matchDate && matchDate >= today) {
            nextMatchIndex = i;
            break;
        }
    }
    
    let html = `
        <caption>Handboll VM 2025 - Sveriges Matcher</caption>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Tid</th>
                <th>Match</th>
                <th>Arena</th>
            </tr>
        </thead>
        <tbody>
    `;
    
    schedule.forEach((game, index) => {
        // Skip matches that have already occurred
        const matchDate = parseDate(game.date);
        if (matchDate && matchDate < today) {
            return;
        }
        
        const isNextMatch = index === nextMatchIndex;
        const rowClass = isNextMatch ? ' class="next-event"' : '';
        
        html += `
            <tr${rowClass}>
                <td>${game.date}</td>
                <td>${game.time}</td>
                <td>${game.match}</td>
                <td>${game.arena}</td>
            </tr>
        `;
    });
    
    html += `</tbody>`;
    table.innerHTML = html;
    return table;
}

// Function to display handball schedule
function displayHandballSchedule(schedule) {
    scheduleContainer.innerHTML = '';
    const table = createHandballTable(schedule);
    scheduleContainer.appendChild(table);
}

// Function to create Vinterstudion table
function createVinterstudionTable(schedule) {
    const table = document.createElement('table');
    table.className = 'schedule-table';
    
    // Find next event
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    let nextEventDate = null;
    for (let i = 0; i < schedule.length; i++) {
        const eventDate = parseDate(schedule[i].date);
        if (eventDate && eventDate >= today) {
            nextEventDate = eventDate;
            break;
        }
    }
    
    let html = `
        <caption>Vinterstudion 2025/2026 - SVT</caption>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Tid</th>
                <th>Sport / Plats</th>
                <th>Gren</th>
            </tr>
        </thead>
        <tbody>
    `;
    
    schedule.forEach(item => {
        const itemDate = parseDate(item.date);
        
        // Skip events that have already occurred
        if (itemDate && itemDate < today) {
            return;
        }
        
        const isNextEvent = nextEventDate && itemDate && 
                           itemDate.getTime() === nextEventDate.getTime();
        const rowClass = isNextEvent ? ' class="next-event"' : '';
        
        html += `
            <tr${rowClass}>
                <td>${item.date}</td>
                <td>${item.time}</td>
                <td>${item.sport}</td>
                <td>${item.event}</td>
            </tr>
        `;
    });
    
    html += `</tbody>`;
    table.innerHTML = html;
    return table;
}

// Function to display Vinterstudion schedule
function displayVinterstudionSchedule(schedule) {
    scheduleContainer.innerHTML = '';
    const table = createVinterstudionTable(schedule);
    scheduleContainer.appendChild(table);
}

// Function to create overview table
function createOverviewTable(events, title) {
    if (events.length === 0) {
        const noEvents = document.createElement('p');
        noEvents.style.padding = '20px';
        noEvents.style.color = '#666';
        noEvents.textContent = 'Inga händelser';
        return noEvents;
    }
    
    const table = document.createElement('table');
    table.className = 'schedule-table';
    
    let html = `
        <caption>${title}</caption>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Sport</th>
                <th>Händelse</th>
                <th>Plats</th>
                <th>Tid/TV</th>
            </tr>
        </thead>
        <tbody>
    `;
    
    events.forEach(event => {
        html += `
            <tr>
                <td>${event.dateString}</td>
                <td>${event.sport}</td>
                <td>${event.description}</td>
                <td>${event.location}</td>
                <td>${event.time}</td>
            </tr>
        `;
    });
    
    html += `</tbody>`;
    table.innerHTML = html;
    return table;
}

// Function to display overview page
function displayOverview() {
    scheduleContainer.innerHTML = '';
    
    const todaysEvents = getTodaysEvents();
    const upcomingEvents = getUpcomingEvents();
    
    // Create container for both sections
    const container = document.createElement('div');
    
    // Today's events section
    const todaySection = document.createElement('div');
    todaySection.style.marginBottom = '50px';
    const todayTable = createOverviewTable(todaysEvents, 'Dagens händelser');
    todaySection.appendChild(todayTable);
    container.appendChild(todaySection);
    
    // Upcoming events section
    const upcomingSection = document.createElement('div');
    const upcomingTable = createOverviewTable(upcomingEvents, 'Kommande händelser (7 dagar)');
    upcomingSection.appendChild(upcomingTable);
    container.appendChild(upcomingSection);
    
    scheduleContainer.appendChild(container);
}

// Initialize the page
function init() {
    try {
        // Show overview by default
        setTimeout(() => {
            displayOverview();
        }, 500);
    } catch (error) {
        console.error('Error loading schedule:', error);
        scheduleContainer.innerHTML = `
            <div class="error">
                <h3>⚠️ Error Loading Schedule</h3>
                <p>We couldn't load the schedule. Please try refreshing the page.</p>
            </div>
        `;
    }
}

// Team selector functionality
document.querySelectorAll('.team-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        // Remove active class from all buttons
        document.querySelectorAll('.team-btn').forEach(b => b.classList.remove('active'));
        // Add active class to clicked button
        this.classList.add('active');
        
        // Get selected sport
        const sport = this.dataset.team;
        
        // Show loading
        scheduleContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Laddar schema...</p></div>';
        
        // Display appropriate schedule
        setTimeout(() => {
            if (sport === 'overview') {
                displayOverview();
            } else if (sport === 'vinterstudion') {
                displayVinterstudionSchedule(vinterstudionSchedule);
            } else if (sport === 'packers') {
                displaySchedule(packersSchedule);
            } else if (sport === 'biathlon') {
                displayBiathlonSchedule(biathlonSchedule);
            } else if (sport === 'handball') {
                displayHandballSchedule(handballSchedule);
            }
        }, 500);
    });
});

// Initialize on page load
document.addEventListener('DOMContentLoaded', init);

